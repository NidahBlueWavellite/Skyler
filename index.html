<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Skyler Novel</title>

<!-- Font -->
<link href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@400;700&display=swap" rel="stylesheet">

<!-- PDF.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
<script>
  pdfjsLib.GlobalWorkerOptions.workerSrc =
    "https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js";
</script>

<style>
  body {
    margin:0;
    font-family:'Roboto Slab', serif;
    color: #001f4d;
    background: linear-gradient(120deg,#E0FFFF 0%,#89CFF0 12%,#87CEEB 25%,#6495ED 38%,#00BFFF 50%,#0096FF 62%,#4fd1c5 72%,#191970 85%,#E0FFFF 100%);
    background-size: 300% 300%;
    animation: chiffonFlow 80s ease-in-out infinite;
    padding:20px;
  }

  @keyframes chiffonFlow {
    0% { background-position:0% 50%; }
    50% { background-position:100% 50%; }
    100% { background-position:0% 50%; }
  }

  .wrapper {
    max-width: 920px;
    margin: auto;
    display:flex;
    flex-direction:column;
    align-items:center;
  }

  header h1 {
    text-align:center;
    font-weight:700;
    margin:0;
    color:#001f4d;
  }

  #novel-title .title-line1 { font-size:3rem; display:block; }
  #novel-title .title-line2 { font-size:2rem; display:block; }

  .cover img {
    width:auto;
    max-width:600px;
    max-height:70vh;
    display:block;
    border-radius:10px;
    margin:20px 0;
  }

  .description {
    max-width:760px;
    text-align:center;
    font-size:1.05rem;
    line-height:1.5;
    margin-bottom:18px;
  }

  .meta-row {
    display:flex;
    flex-direction:column;
    align-items:center;
    gap:12px;
    margin-bottom:24px;
  }

  .genre {
    padding:10px 14px;
    border-radius:8px;
    background: rgba(255,255,255,0.06);
    font-weight:700;
    text-align:center;
  }

  .download button {
    padding:12px 28px;
    border-radius:8px;
    background: rgba(255,255,255,0.9);
    color:#001f4d;
    border:none;
    font-weight:700;
    cursor:pointer;
  }

  .download button:hover { background:#ffffff; transform:scale(1.03); }

  /* PDF Viewer inline */
  #pdfControlsContainer {
    display:none;
    flex-direction:row;
    align-items:center;
    justify-content:center;
    gap:12px;
    margin:12px 0;
    flex-wrap:wrap;
  }

  #pdfControlsContainer input[type=number] {
    width:50px;
    text-align:center;
  }

  #pdfContainer {
    display:none;
    overflow-y:auto;
    max-height:80vh;
    width:100%;
    border-radius:8px;
    background:#ffffff;
    padding:10px;
  }

  canvas {
    display:block;
    margin:auto;
    margin-bottom:10px;
    border-radius:4px;
    box-shadow:0px 2px 6px rgba(0,0,0,0.2);
  }

  #backToCoverBtn {
    display:none;
    padding:8px 16px;
    margin-bottom:12px;
    border:none;
    border-radius:6px;
    background:#001f4d;
    color:#ffffff;
    font-weight:600;
    cursor:pointer;
  }

  .comments {
    max-width:760px;
    margin-top:28px;
    color:#001f4d;
  }

  .comments h2 { text-align:center; }

  @media (max-width:520px){
    #novel-title .title-line1 { font-size:2rem; }
    #novel-title .title-line2 { font-size:1.5rem; }
    .cover img { max-width:260px; max-height:50vh; }
  }
</style>
</head>
<body>
<div class="wrapper">
  <header>
    <h1 id="novel-title">
      <span class="title-line1">Skyler,</span>
      <span class="title-line2">I wish to breathe another season</span>
    </h1>
  </header>

  <div class="cover">
    <img src="Skyler.png" alt="Skyler cover">
  </div>

  <div class="description">
    Nova, a girl who prefers solitude, unexpectedly meets a friend who draws her into new experiences...
  </div>

  <div class="meta-row">
    <div class="genre">Genre: Slice of Life, Literary Fiction, Nature-Inspired, Personal Journey</div>
    <div class="download">
      <button id="openPdfBtn">Read Now</button>
    </div>
  </div>

  <button id="backToCoverBtn">Back to Cover</button>

  <!-- PDF Controls -->
  <div id="pdfControlsContainer">
    <button id="prevPage">Prev</button>
    <input type="number" id="pageNum" value="1"> / <span id="totalPages">?</span>
    <button id="nextPage">Next</button>
    <button id="zoomIn">Zoom In</button>
    <button id="zoomOut">Zoom Out</button>
  </div>

  <div id="pdfContainer"></div>

  <section class="comments">
    <h2>Comments</h2>
    <button id="loginBtn">Login with Google</button><br>
    <input type="text" id="commentInput" placeholder="Write a comment...">
    <button id="commentBtn">Post</button>
    <div id="commentsList"></div>
  </section>
</div>

<script>
const pdfUrl = "https://drive.google.com/uc?export=download&id=FILE_ID";

const openPdfBtn = document.getElementById("openPdfBtn");
const backToCoverBtn = document.getElementById("backToCoverBtn");
const pdfContainer = document.getElementById("pdfContainer");
const pdfControls = document.getElementById("pdfControlsContainer");
const prevBtn = document.getElementById("prevPage");
const nextBtn = document.getElementById("nextPage");
const pageNumInput = document.getElementById("pageNum");
const totalPagesSpan = document.getElementById("totalPages");
const zoomInBtn = document.getElementById("zoomIn");
const zoomOutBtn = document.getElementById("zoomOut");

let pdfDoc = null;
let currentPage = 1;
let totalPages = 0;
let scale = 1.2;

// Open PDF
openPdfBtn.addEventListener("click", async () => {
  openPdfBtn.style.display = "none";
  backToCoverBtn.style.display = "inline-block";
  pdfControls.style.display = "flex";
  pdfContainer.style.display = "block";
  if (!pdfDoc) {
    pdfDoc = await pdfjsLib.getDocument(pdfUrl).promise;
    totalPages = pdfDoc.numPages;
    totalPagesSpan.textContent = totalPages;
    renderPDF();
  }
});

// Back to cover
backToCoverBtn.addEventListener("click", () => {
  pdfContainer.scrollTo({ top:0, behavior:'smooth' });
  pdfContainer.style.display = "none";
  pdfControls.style.display = "none";
  openPdfBtn.style.display = "inline-block";
  backToCoverBtn.style.display = "none";
});

// Render all pages inline
async function renderPDF() {
  pdfContainer.innerHTML = "";
  for (let i=1; i<=totalPages; i++) {
    const page = await pdfDoc.getPage(i);
    const viewport = page.getViewport({ scale });
    const canvas = document.createElement("canvas");
    canvas.width = viewport.width;
    canvas.height = viewport.height;
    await page.render({ canvasContext: canvas.getContext("2d"), viewport }).promise;
    canvas.dataset.pageNumber = i;
    pdfContainer.appendChild(canvas);
  }
  currentPage = 1;
  pageNumInput.value = currentPage;
}

// Navigation
prevBtn.addEventListener("click", () => {
  if(currentPage<=1) return;
  currentPage--;
  scrollToPage(currentPage);
  pageNumInput.value = currentPage;
});

nextBtn.addEventListener("click", () => {
  if(currentPage>=totalPages) return;
  currentPage++;
  scrollToPage(currentPage);
  pageNumInput.value = currentPage;
});

pageNumInput.addEventListener("change", () => {
  let val = parseInt(pageNumInput.value);
  if(val<1) val=1;
  if(val>totalPages) val=totalPages;
  currentPage = val;
  scrollToPage(currentPage);
});

function scrollToPage(num) {
  const canvas = pdfContainer.querySelector(`canvas[data-page-number='${num}']`);
  if(canvas) canvas.scrollIntoView({behavior:"smooth"});
}

// Zoom
zoomInBtn.addEventListener("click", async () => { scale+=0.2; await renderPDF(); });
zoomOutBtn.addEventListener("click", async () => { if(scale>0.4){ scale-=0.2; await renderPDF(); } });

</script>
</body>
</html>
