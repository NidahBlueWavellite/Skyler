<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Skyler Novel</title>

<!-- Font -->
<link href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@400;700&display=swap" rel="stylesheet">

<!-- PDF.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
<script>
  pdfjsLib.GlobalWorkerOptions.workerSrc =
    "https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js";
</script>

<style>
  body {
    margin: 0;
    font-family: "Roboto Slab", serif;
    color: #001f4d;
    background: linear-gradient(
      120deg,
      #e0ffff 0%,
      #89cff0 12%,
      #87ceeb 25%,
      #6495ed 38%,
      #00bfff 50%,
      #0096ff 62%,
      #4fd1c5 72%,
      #191970 85%,
      #e0ffff 100%
    );
    background-size: 300% 300%;
    animation: chiffonFlow 80s ease-in-out infinite;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 28px 16px;
  }

  @keyframes chiffonFlow {
    0% {
      background-position: 0% 50%;
    }
    50% {
      background-position: 100% 50%;
    }
    100% {
      background-position: 0% 50%;
    }
  }

  .wrapper {
    width: 100%;
    max-width: 920px;
    padding: 30px;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  header h1 {
    color: #001f4d;
    text-align: center;
  }

  #novel-title .title-line1 {
    font-size: 3rem;
    display: block;
  }
  #novel-title .title-line2 {
    font-size: 2rem;
    display: block;
  }

  .cover {
    display: flex;
    justify-content: center;
    margin: 24px 0;
    background: transparent;
  }

  .cover img {
    max-width: 600px;
    max-height: 90vh;
    display: block;
    object-fit: contain;
    border-radius: 10px;
    background: transparent;
  }

  .description {
    max-width: 760px;
    margin: 18px auto;
    text-align: center;
    color: #001f4d;
    font-size: 1.05rem;
    line-height: 1.5;
  }

  .meta-row {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 12px;
    margin-top: 18px;
    width: 100%;
    max-width: 760px;
  }

  .genre {
    padding: 10px 14px;
    border-radius: 8px;
    background: rgba(255, 255, 255, 0.06);
    color: #001f4d;
    font-weight: 700;
    text-align: center;
  }

  .download button {
    padding: 12px 28px;
    border-radius: 8px;
    background: rgba(255, 255, 255, 0.9);
    color: #001f4d;
    border: none;
    font-weight: 700;
    cursor: pointer;
    transition: background 0.3s, transform 0.2s;
  }

  .download button:hover {
    background: #ffffff;
    transform: scale(1.03);
  }

  .comments {
    margin-top: 28px;
    padding: 18px;
    color: #001f4d;
    width: 100%;
    max-width: 760px;
  }

  .comments h2 {
    margin: 0 0 10px 0;
    text-align: center;
    color: #001f4d;
  }

  @media (max-width: 520px) {
    #novel-title .title-line1 {
      font-size: 2rem;
    }
    #novel-title .title-line2 {
      font-size: 1.5rem;
    }
    .cover img {
      max-width: 260px;
      max-height: 70vh;
    }
  }
</style>
</head>
<body>
<div class="wrapper">
  <header>
    <h1 id="novel-title">
      <span class="title-line1">Skyler,</span>
      <span class="title-line2">I wish to breathe another season</span>
    </h1>
  </header>

  <div class="cover">
    <img src="Skyler.png" alt="Skyler cover image" loading="lazy">
  </div>

  <div class="description" id="desc">
    Nova, a girl who prefers solitude, unexpectedly meets a friend who draws her into new experiences. Through fleeting days and quiet moments, she gradually rediscovers the sources of hope, connection, and the simple joys that give life its breath. A nature-infused journey of friendship, resilience, and self-discovery.
  </div>

  <div class="meta-row">
    <div class="genre">
      Genre: Slice of Life, Literary Fiction, Nature-Inspired, Personal Journey
    </div>
    <div class="download">
      <button id="openPdfBtn">Read Now</button>
    </div>
  </div>

  <section class="comments">
    <h2>Comments</h2>
    <button
      id="loginBtn"
      style="padding:6px 12px;margin-bottom:12px;border-radius:6px;border:none;background:#ffffff;color:#001f4d;font-weight:600;cursor:pointer;"
    >
      Login with Google
    </button>

    <input
      type="text"
      id="commentInput"
      placeholder="Write a comment..."
      style="width:70%;padding:6px;margin-top:12px;border-radius:6px;border:none;"
    />
    <button
      id="commentBtn"
      style="padding:6px 12px;margin-left:6px;border-radius:6px;border:none;background:#ffffff;color:#001f4d;font-weight:600;cursor:pointer;"
    >
      Post
    </button>

    <div id="commentsList" style="margin-top:12px;"></div>
  </section>
</div>

<script>
// your working raw PDF link:
const pdfUrl = "https://bluewavellite.github.io/Skyler/Skyler.pdf";

document.getElementById("openPdfBtn").addEventListener("click", () => {
  // open viewer in new tab
  const newTab = window.open("", "_blank");
  newTab.document.write(`
    <!DOCTYPE html>
    <html><head><title>Skyler PDF</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"><\/script>
    <script>
      pdfjsLib.GlobalWorkerOptions.workerSrc = "https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js";
    <\/script>
    <style>
      body{margin:0;background:#0b2740;color:white;font-family:sans-serif;text-align:center;}
      #toolbar{background:#09213a;padding:8px;position:sticky;top:0;display:flex;justify-content:center;align-items:center;gap:6px;}
      #toolbar input{width:50px;text-align:center;}
      #viewer{padding:10px;overflow-y:auto;}
      canvas{display:block;margin:0 auto 10px auto;max-width:90%;}
      button{padding:4px 8px;border:none;border-radius:4px;cursor:pointer;}
    </style></head>
    <body>
    <div id="toolbar">
      <button id="prev">Prev</button>
      <input type="number" id="page_num" value="1" min="1">
      / <span id="page_count">?</span>
      <button id="next">Next</button>
      <button id="zoom_in">+</button>
      <button id="zoom_out">-</button>
      <button id="closeBtn">Close</button>
    </div>
    <div id="viewer"></div>
    <script>
      const url = "${pdfUrl}";
      let pdfDoc=null,pageNum=1,scale=1.2,canvas,ctx;
      const viewer=document.getElementById('viewer');
      const pageCount=document.getElementById('page_count');
      function renderPage(num){
        pdfDoc.getPage(num).then(page=>{
          const viewport=page.getViewport({scale:scale});
          const canvas=document.createElement('canvas');
          const context=canvas.getContext('2d');
          canvas.height=viewport.height;
          canvas.width=viewport.width;
          viewer.innerHTML='';
          viewer.appendChild(canvas);
          const renderContext={canvasContext:context,viewport:viewport};
          page.render(renderContext);
          document.getElementById('page_num').value=num;
        });
      }
      pdfjsLib.getDocument(url).promise.then(doc=>{
        pdfDoc=doc;
        pageCount.textContent=pdfDoc.numPages;
        renderPage(pageNum);
      });
      document.getElementById('prev').onclick=()=>{if(pageNum<=1)return;pageNum--;renderPage(pageNum);};
      document.getElementById('next').onclick=()=>{if(pageNum>=pdfDoc.numPages)return;pageNum++;renderPage(pageNum);};
      document.getElementById('zoom_in').onclick=()=>{scale+=0.2;renderPage(pageNum);};
      document.getElementById('zoom_out').onclick=()=>{if(scale>0.4){scale-=0.2;renderPage(pageNum);}};
      document.getElementById('page_num').addEventListener('keypress',e=>{
        if(e.key==='Enter'){
          let n=parseInt(e.target.value);
          if(n>=1 && n<=pdfDoc.numPages){pageNum=n;renderPage(pageNum);}
        }
      });
      document.getElementById('closeBtn').onclick=()=>window.close();
    <\/script>
    </body></html>
  `);
});
</script>

<!-- Firebase Comments (unchanged) -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-app.js";
import { getFirestore, collection, addDoc, query, orderBy, onSnapshot, serverTimestamp } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-firestore.js";
import { getAuth, signInWithPopup, GoogleAuthProvider } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyBjbxPH-mjjJO9z-CcFTeZrBD0byvSuiqQ",
  authDomain: "novel-comment.firebaseapp.com",
  projectId: "novel-comment",
  storageBucket: "novel-comment.appspot.com",
  messagingSenderId: "581499177533",
  appId: "1:581499177533:web:a5312ad34f3b9ae863f854",
  measurementId: "G-KP9594R9FQ",
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const auth = getAuth(app);
const provider = new GoogleAuthProvider();
let currentUser = null;

const loginBtn = document.getElementById("loginBtn");
const commentInput = document.getElementById("commentInput");
const commentBtn = document.getElementById("commentBtn");
const commentsList = document.getElementById("commentsList");

loginBtn.addEventListener("click", async () => {
  try {
    const result = await signInWithPopup(auth, provider);
    currentUser = result.user;
    alert(\`Logged in as \${currentUser.displayName}\`);
    loginBtn.style.display = "none";
  } catch (error) {
    console.error(error);
  }
});

commentBtn.addEventListener("click", async () => {
  if (!currentUser) {
    alert("Please log in first!");
    return;
  }
  const text = commentInput.value.trim();
  if (!text) return;
  await addDoc(collection(db, "comments"), {
    text,
    name: currentUser.displayName,
    timestamp: serverTimestamp(),
  });
  commentInput.value = "";
});

const q = query(collection(db, "comments"), orderBy("timestamp"));
onSnapshot(q, (snapshot) => {
  commentsList.innerHTML = "";
  snapshot.forEach((doc) => {
    const data = doc.data();
    const div = document.createElement("div");
    div.textContent = \`\${data.name || "Anonymous"}: \${data.text}\`;
    div.style.padding = "8px 12px";
    div.style.marginBottom = "6px";
    div.style.background = "rgba(0,31,77,0.1)";
    div.style.borderRadius = "6px";
    commentsList.appendChild(div);
  });
});
</script>
</body>
</html>

